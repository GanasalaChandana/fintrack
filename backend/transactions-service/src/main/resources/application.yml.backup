spring:
  application:
    name: transactions-service

  datasource:
    # LOCAL DEFAULTS
    url: jdbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:5432}/${POSTGRES_DB:fintrack}?currentSchema=transactions
    username: ${POSTGRES_USER:postgres}
    password: ${POSTGRES_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: none
      naming:
        physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
        implicit-strategy: org.hibernate.boot.model.naming.ImplicitNamingStrategyJpaCompliantImpl
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        default_schema: transactions
        default_catalog: ""

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    schemas: transactions
    default-schema: public
    # bind Flyway to the same DS
    url: ${spring.datasource.url}
    user: ${spring.datasource.username}
    password: ${POSTGRES_PASSWORD:postgres}

server:
  port: ${SERVER_PORT:8082}

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  prometheus:
    metrics:
      export:
        enabled: true
  health:
    kafka:
      enabled: false

ml-classifier:
  url: http://ml-classifier:8000
  enabled: false

logging:
  level:
    com.fintrack: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE

---
# DOCKER profile
spring:
  config:
    activate:
      on-profile: docker
  datasource:
    url: jdbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:5432}/${POSTGRES_DB:fintrack}?currentSchema=transactions
    username: fintrack_user
    password: fintrack_pass
  flyway:
    url: ${spring.datasource.url}
    user: ${spring.datasource.username}
    password: ${POSTGRES_PASSWORD:postgres}
